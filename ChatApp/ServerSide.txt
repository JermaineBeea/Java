import java.net.ServerSocket;
import java.net.Socket;
import java.net.InetAddress;
import java.io.IOException;

import static ServerUtility.*;

public class ServerSide{
    private static final int SERVERPORT = 1700;
    private static final String SERVERIP = "localhost";

    public static void main(String[] args){

        System.out.println("Establishing connection to " + SERVERPORT + "...");

        try(
            InetAddress networkInterface = InetAddress.getByName("0.0.0.0");
            ServerSocket server =  new ServerSocket(SERVERPORT, 50, networkInterface)
        ){
            System.out.println("Connected to Server at " + server.getInetAddress().getHostAddress());
            delayPrint(2,"Waiting for clients to connect...");

            // Accept client connections, and create new client thread.
            int clientcount = 1;
            while(true)
            {
                Socket clientsocket = server.accept();
                System.out.println("Client " + clientcount + ", is connected");

            // Send client instance to clientHandler.
                final int clientID = clientcount;
                new Thread(()-> clientThread(clientID, clientsocket)).start();
            }

        }catch(IOException e){
            System.out.println("Server Error: " + e.getMessage());
        }
    }
}